# LyE (lud-x-south): docx -> txt with copy-paste
# Nettisanat_LyE (lud-x-south): ods -> csv with export using | as delimiter
# LyK_Simonas (lud-x-middle): ods -> csv with export using | as delimiter
# LyKK-ven (lud): docx -> txt with copy-paste
# LyKK-SU: docx -> ods with copy paste -> csv with export using | as delimiter
# LyP (lud-x-north): xlsx -> csv with export using | as delimiter

OUTPUT=$(pwd)/output
INPUT=$(pwd)/aineistot
DELETIONS=$(pwd)/todelete.txt
RUN=$(pwd)/../../maintenance/run
IMPORTER=$(pwd)/../Sanat/SanatImport.php

rm -rf "$OUTPUT" "$DELETIONS"
mkdir "$OUTPUT"

"$RUN" Lud:import "$OUTPUT" \
  --LyE-txt="$INPUT"/LyE.txt \
  --LyE-csv="$INPUT"/Nettisanat_LyE.csv \
  --LyK="$INPUT"/LyK_Simonas.csv \
  --LyKK-txt="$INPUT"/LyKK.txt \
  --LyKK-csv="$INPUT"/LyKK-SU.csv \
  --LyP="$INPUT"/LyP.csv
"$RUN" Lud:list-pages-to-delete "$OUTPUT" > "$DELETIONS"
"$RUN" "$IMPORTER" --threads=$(nproc) "$(pwd)/mw"
"$RUN" "$IMPORTER" --threads=$(nproc) "$OUTPUT"
"$RUN" deleteBatch "$DELETIONS"
